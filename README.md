# Tailwind Scope

A utility library that creates isolated scopes for Tailwind CSS using Web Components. It combines [Twind](https://twind.style/) (a Tailwind CSS-in-JS solution) with Shadow DOM to provide scoped styling [basic example(codePen)](https://codepen.io/danielchan27/full/RNPPqmG).

![](https://cdn.danni.cool/self/lGGNQifm.png)

## Features

- üîç **Isolated CSS Scopes**: Use Tailwind classes within shadow DOM for true isolation
- üéØ **Component-specific Styling**: Apply styles only to specific components without affecting others
- üß© **Web Component Based**: Uses custom elements with shadow DOM
- ‚ö° **Alpine.js Integration**: Includes Alpine.js for reactive components
- üîÑ **Dynamic Configuration**: Configure components via data attributes

## Usage

### Basic Usage

```html
<twind-scope>
  <h1 class="text-3xl font-bold underline">Hello world!</h1>
</twind-scope>
```

### With Component Properties

```html
<twind-scope data-props='{"type":"hero-image-horizontal", "id":"hero_1"}'>
  <h1 class="text-3xl font-bold underline">Hello world!</h1>
</twind-scope>
```

The `data-props` attribute accepts a JSON string with the following properties:

- `type`: Adds a class to the first element inside the shadow DOM
- `id`: Sets the ID of the first element inside the shadow DOM (as `${type}-${id}`)
- `script`: Optional inline JavaScript to execute within the component

### Using Scripts with Tailwind

#### Inline Scripts in Components

You can add component-specific JavaScript by including a script property in the data-props:

```html
<twind-scope data-props='{
  "type": "interactive-card",
  "id": "card_1",
  "script": "
    const button = this.querySelector('.btn');
    button.addEventListener('click', () => {
      button.classList.toggle('bg-green-500');
      button.classList.toggle('bg-blue-500');
    });
  "
}'>
  <div class="p-6 max-w-sm mx-auto bg-white rounded-xl shadow-md">
    <h2 class="text-xl font-medium text-black">Interactive Card</h2>
    <button class="mt-4 px-4 py-2 bg-blue-500 text-white rounded btn">
      Toggle Color
    </button>
  </div>
</twind-scope>
```

#### Global Scripts

To include scripts in all your `twind-scope` components, use the global configuration:

```html
<script>
  window.TwindScope = {
    script: [
      // External script
      'https://cdn.example.com/my-utilities.js',

      // Inline script that will run in all components
      `
        // This function will be available in all twind-scope components
        function toggleClasses(element, ...classes) {
          classes.forEach(className => element.classList.toggle(className));
        }
      `,
    ],
  }
</script>
```

#### Combining Dynamic Classes with Scripts

You can use JavaScript to dynamically add or remove Tailwind classes:

```html
<twind-scope data-props='{
  "script": "
    const counter = this.querySelector(\'#counter\');
    let count = 0;

    this.querySelector(\'.increment\').addEventListener(\'click\', () => {
      count++;
      counter.textContent = count;

      // Add/remove Tailwind classes based on state
      if (count > 5) {
        counter.classList.add(\'text-red-500\');
        counter.classList.remove(\'text-blue-500\');
      } else {
        counter.classList.add(\'text-blue-500\');
        counter.classList.remove(\'text-red-500\');
      }
    });
  "
}'>
  <div class="p-4 border rounded">
    <h2 class="text-lg">Counter: <span id="counter" class="text-blue-500">0</span></h2>
    <button class="increment px-2 py-1 bg-gray-200 rounded mt-2">Increment</button>
  </div>
</twind-scope>
```

### Alpine.js Integration with Tailwind

[Alpine.js](https://alpinejs.dev/) is a lightweight JavaScript framework that offers reactive and declarative capabilities. Tailwind Scope automatically initializes Alpine.js inside each component, making it easy to create interactive UI elements with isolated styling.

#### Basic Alpine.js Example

```html
<twind-scope>
  <div x-data="{ count: 0 }" class="p-4 bg-white rounded shadow">
    <h2 class="text-lg font-medium mb-2">Alpine.js Counter</h2>
    <p class="mb-4">
      Current count: <span x-text="count" class="font-bold"></span>
    </p>
    <div class="flex space-x-2">
      <button
        @click="count++"
        class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600"
      >
        Increment
      </button>
      <button
        @click="count--"
        class="px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600"
      >
        Decrement
      </button>
    </div>
  </div>
</twind-scope>
```

#### Toggling Tailwind Classes with Alpine.js

You can dynamically toggle Tailwind classes based on Alpine.js state:

```html
<twind-scope>
  <div x-data="{ isActive: false }" class="p-4 bg-white rounded shadow">
    <div
      @click="isActive = !isActive"
      :class="isActive ? 'bg-blue-100 border-blue-500' : 'bg-gray-100 border-gray-300'"
      class="p-4 border-2 rounded cursor-pointer transition-colors duration-200"
    >
      <h3
        class="font-medium"
        x-text="isActive ? 'Active State' : 'Inactive State'"
      ></h3>
      <p
        class="mt-2 text-sm"
        x-text="isActive ? 'Click to deactivate' : 'Click to activate'"
      ></p>
    </div>
  </div>
</twind-scope>
```

#### Alpine.js Dropdown Example

Here's how to create a dropdown menu using Alpine.js with Tailwind classes:

```html
<twind-scope>
  <div x-data="{ open: false }" class="relative">
    <button
      @click="open = !open"
      class="px-4 py-2 bg-blue-500 text-white rounded"
    >
      Toggle Dropdown
    </button>

    <div x-show="open" class="absolute mt-2 w-48 bg-white rounded shadow-lg">
      <a href="#" class="block px-4 py-2 text-gray-800 hover:bg-blue-100"
        >Option 1</a
      >
      <a href="#" class="block px-4 py-2 text-gray-800 hover:bg-blue-100"
        >Option 2</a
      >
    </div>
  </div>
</twind-scope>
```

#### Complex Example: Form with Validation

```html
<twind-scope>
  <div
    x-data="{ 
    email: '',
    password: '',
    errors: {},
    validateForm() {
      this.errors = {};
      if (!this.email) this.errors.email = 'Email is required';
      if (!this.password) this.errors.password = 'Password is required';
      return Object.keys(this.errors).length === 0;
    },
    submitForm() {
      if (this.validateForm()) {
        alert('Form submitted successfully!');
      }
    }
  }"
    class="max-w-md mx-auto p-6 bg-white rounded shadow-md"
  >
    <h2 class="text-xl font-semibold mb-4">Login Form</h2>

    <div class="mb-4">
      <label class="block text-gray-700 mb-1">Email</label>
      <input
        type="email"
        x-model="email"
        class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-300"
        :class="errors.email ? 'border-red-500' : 'border-gray-300'"
      />
      <p
        x-show="errors.email"
        x-text="errors.email"
        class="mt-1 text-sm text-red-500"
      ></p>
    </div>

    <div class="mb-6">
      <label class="block text-gray-700 mb-1">Password</label>
      <input
        type="password"
        x-model="password"
        class="w-full px-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-300"
        :class="errors.password ? 'border-red-500' : 'border-gray-300'"
      />
      <p
        x-show="errors.password"
        x-text="errors.password"
        class="mt-1 text-sm text-red-500"
      ></p>
    </div>

    <button
      @click="submitForm()"
      class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600 focus:outline-none"
    >
      Log In
    </button>
  </div>
</twind-scope>
```

#### Accessing Alpine.js Inside Script

You can also access Alpine.js functionality within your component's script:

```html
<twind-scope data-props='{
  "script": "
    const container = this.querySelector(\'.alpine-container\');

    // Access Alpine.js data on an element
    const getData = () => Alpine.$data(container);

    // Register a custom event handler
    this.querySelector(\'.special-action\').addEventListener(\'click\', () => {
      const data = getData();
      data.count += 10; // Update Alpine state directly
    });
  "
}'>
  <div x-data="{ count: 0 }" class="alpine-container p-4 bg-white rounded shadow">
    <p class="mb-4">Count: <span x-text="count"></span></p>
    <div class="flex space-x-2">
      <button @click="count++" class="px-3 py-1 bg-blue-500 text-white rounded">
        Add 1
      </button>
      <button class="special-action px-3 py-1 bg-green-500 text-white rounded">
        Add 10
      </button>
    </div>
  </div>
</twind-scope>
```

For more information on Alpine.js capabilities and directives, refer to the [official Alpine.js documentation](https://alpinejs.dev/start-here).

#### Global Configuration with Alpine.js

```html
<script>
  window.TwindScope = {
    config: {
      // Twind configurations
    },
    style: [
      // Style configurations
    ],
    script: [
      // Custom Alpine.js components or plugins
      `
        document.addEventListener('alpine:init', () => {
          Alpine.data('counter', () => ({
            count: 0,
            increment() { this.count++ },
            decrement() { this.count-- }
          }))
        })
      `,
    ],
  }
</script>

<!-- Then use in your component -->
<twind-scope>
  <div x-data="counter" class="p-4 bg-white rounded shadow">
    <p>Count: <span x-text="count"></span></p>
    <button
      @click="increment()"
      class="px-3 py-1 bg-blue-500 text-white rounded"
    >
      +
    </button>
    <button
      @click="decrement()"
      class="px-3 py-1 bg-red-500 text-white rounded"
    >
      -
    </button>
  </div>
</twind-scope>
```

## Global Configuration

You can configure Twind globally by setting `window.TwindScope` before the component is loaded:

```html
<script>
  window.TwindScope = {
    // Twind configuration
    config: {
      // Custom theme or other Twind options
    },
    // Global styles to apply to all twind-scope components
    style: [
      // Inline styles or URLs to CSS files
      'https://example.com/styles.css',
      'body { margin: 0; }',
    ],
    // Global scripts to include in all twind-scope components
    script: [
      // Inline scripts or URLs to JS files
      'https://example.com/script.js',
      'console.log("Hello from twind-scope!")',
    ],
  }
</script>
```

## Development

```bash
# Start development server
pnpm dev

# Build for production
pnpm build
```

## How It Works

Tailwind Scope creates a custom element called `<twind-scope>` that:

1. Uses Shadow DOM to create an isolated DOM tree
2. Applies Twind (Tailwind CSS-in-JS) within that shadow DOM
3. Moves your content into the shadow DOM
4. Initializes Alpine.js within the shadow DOM if present
5. Applies any specified type/ID to the first child element

This approach allows you to use Tailwind classes in isolation, preventing style conflicts between different parts of your application.

## Dependencies

- [@twind/core](https://twind.style/): Core Twind functionality
- [@twind/preset-autoprefix](https://twind.style/): Autoprefixer for Twind
- [@twind/preset-tailwind](https://twind.style/): Tailwind CSS preset for Twind
- [@twind/with-web-components](https://twind.style/): Web Component integration for Twind
- [Alpine.js](https://alpinejs.dev/): Lightweight JavaScript framework for reactivity

# TwindScope ÂÖ±‰∫´ Resize ‰∫ã‰ª∂Ëß£ÂÜ≥ÊñπÊ°à

## ÈóÆÈ¢òÊèèËø∞

Âú®‰ΩøÁî®Â§ö‰∏™ `twind-scope` Shadow DOM ÂÆû‰æãÊó∂ÔºåÂ¶ÇÊûúÊØè‰∏™ÂÆû‰æãÈÉΩÂçïÁã¨ÁõëÂê¨ `resize` ‰∫ã‰ª∂Ôºå‰ºöÂØºËá¥Ôºö

- ÊÄßËÉΩÈóÆÈ¢òÔºöÂ§ö‰∏™ÈáçÂ§çÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
- ÂÜÖÂ≠òÊ≥ÑÊºèÈ£éÈô©Ôºö‰∫ã‰ª∂ÁõëÂê¨Âô®Êú™Ê≠£Á°ÆÊ∏ÖÁêÜ
- ‰ª£Á†ÅÂÜó‰ΩôÔºöÈáçÂ§çÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÈÄªËæë

## Ëß£ÂÜ≥ÊñπÊ°à

ÂÆûÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ®Â±ÄÁöÑ `ResizeManager` Âçï‰æãÊ®°ÂºèÔºåËÆ©ÊâÄÊúâ `twind-scope` ÂÆû‰æãÂÖ±‰∫´Âêå‰∏Ä‰∏™ resize ‰∫ã‰ª∂ÁõëÂê¨Âô®„ÄÇ

### Ê†∏ÂøÉÁâπÊÄß

1. **Âçï‰æãÊ®°Âºè**: ÂÖ®Â±ÄÂè™Êúâ‰∏Ä‰∏™ resize ‰∫ã‰ª∂ÁõëÂê¨Âô®
2. **Ëá™Âä®ÁÆ°ÁêÜ**: ÂΩìÊúâÂÆû‰æãÈúÄË¶ÅÊó∂Ëá™Âä®Ê∑ªÂä†ÁõëÂê¨Âô®ÔºåÂΩìÊ≤°ÊúâÂÆû‰æãÊó∂Ëá™Âä®ÁßªÈô§
3. **Alpine.js ÈõÜÊàê**: ‰∏∫ÊØè‰∏™ÂÆû‰æãÊèê‰æõÂìçÂ∫îÂºèÁöÑÂ∞∫ÂØ∏Êï∞ÊçÆ
4. **Êñ≠ÁÇπÊ£ÄÊµã**: ÂÜÖÁΩÆÂ∏∏Áî®ÁöÑÂìçÂ∫îÂºèÊñ≠ÁÇπÂà§Êñ≠
5. **ÈîôËØØÂ§ÑÁêÜ**: ÂÆâÂÖ®ÁöÑÂõûË∞ÉÊâßË°åÔºåÈÅøÂÖçÂçï‰∏™ÂÆû‰æãÈîôËØØÂΩ±ÂìçÂÖ∂‰ªñÂÆû‰æã

## ÂÆûÁé∞ÂéüÁêÜ

### ResizeManager Á±ª

```typescript
class ResizeManager {
  private static instance: ResizeManager
  private listeners: Set<(width: number, height: number) => void> = new Set()
  private isListening = false

  // Âçï‰æãÊ®°Âºè
  static getInstance(): ResizeManager

  // Ê∑ªÂä†ÁõëÂê¨Âô®
  addListener(callback: (width: number, height: number) => void): void

  // ÁßªÈô§ÁõëÂê¨Âô®
  removeListener(callback: (width: number, height: number) => void): void
}
```

### TwindScope ÈõÜÊàê

ÊØè‰∏™ `twind-scope` ÂÆû‰æãÔºö

1. Âú® `connectedCallback` Êó∂Ê≥®ÂÜåÂà∞ ResizeManager
2. Âú® `disconnectedCallback` Êó∂‰ªé ResizeManager Ê≥®ÈîÄ
3. Áª¥Êä§Ëá™Â∑±ÁöÑ Alpine.js ÂìçÂ∫îÂºèÊï∞ÊçÆ
4. ÈÄöËøáÂõûË∞ÉÂáΩÊï∞Êõ¥Êñ∞Ëá™Â∑±ÁöÑÂ∞∫ÂØ∏Êï∞ÊçÆ

## ‰ΩøÁî®ÊñπÊ≥ï

### Âü∫Á°ÄÁî®Ê≥ï

```html
<twind-scope>
  <div class="p-4">
    <p x-text="`ÂΩìÂâçÂÆΩÂ∫¶: ${windowWidth}px`"></p>
    <p x-text="`ÂΩìÂâçÈ´òÂ∫¶: ${windowHeight}px`"></p>
  </div>
</twind-scope>
```

### ÂìçÂ∫îÂºèÊñ≠ÁÇπÊ£ÄÊµã

```html
<twind-scope>
  <div
    :class="{
    'bg-red-100': isMobile,
    'bg-yellow-100': isTablet,
    'bg-green-100': isDesktop
  }"
  >
    <div x-show="isMobile">ÁßªÂä®Á´ØËßÜÂõæ</div>
    <div x-show="isTablet">Âπ≥ÊùøËßÜÂõæ</div>
    <div x-show="isDesktop">Ê°åÈù¢ËßÜÂõæ</div>
  </div>
</twind-scope>
```

### Ëá™ÂÆö‰πâÂìçÂ∫îÂºèÈÄªËæë

```html
<twind-scope>
  <div
    x-data="{
    get aspectRatio() {
      return (windowWidth / windowHeight).toFixed(2)
    },
    get isWideScreen() {
      return windowWidth / windowHeight > 1.5
    }
  }"
  >
    <p x-text="`Â±èÂπïÊØî‰æã: ${aspectRatio}`"></p>
    <div x-show="isWideScreen">ÂÆΩÂ±èÊ®°Âºè</div>
  </div>
</twind-scope>
```

## ÂèØÁî®ÁöÑÂìçÂ∫îÂºèÂ±ûÊÄß

ÊØè‰∏™ `twind-scope` ÂÆû‰æãÈÉΩÂèØ‰ª•ËÆøÈóÆ‰ª•‰∏ãÂìçÂ∫îÂºèÂ±ûÊÄßÔºö

### Âü∫Á°ÄÂ∞∫ÂØ∏

- `windowWidth`: ÂΩìÂâçÁ™óÂè£ÂÆΩÂ∫¶
- `windowHeight`: ÂΩìÂâçÁ™óÂè£È´òÂ∫¶

### ËÆæÂ§áÁ±ªÂûãÊñ≠ÁÇπ

- `isMobile`: ÂÆΩÂ∫¶ < 768px
- `isTablet`: 768px ‚â§ ÂÆΩÂ∫¶ < 1024px
- `isDesktop`: ÂÆΩÂ∫¶ ‚â• 1024px

### Tailwind CSS Êñ≠ÁÇπ

- `isSmall`: ÂÆΩÂ∫¶ < 640px
- `isMedium`: 640px ‚â§ ÂÆΩÂ∫¶ < 1024px
- `isLarge`: ÂÆΩÂ∫¶ ‚â• 1024px
- `isXLarge`: ÂÆΩÂ∫¶ ‚â• 1280px
- `is2XLarge`: ÂÆΩÂ∫¶ ‚â• 1536px

## ÊÄßËÉΩ‰ºòÂäø

### ÂØπÊØî‰º†ÁªüÊñπÊ°à

**‰º†ÁªüÊñπÊ°àÔºàÊØè‰∏™ÂÆû‰æã‰∏Ä‰∏™ÁõëÂê¨Âô®Ôºâ:**

```javascript
// ÊØè‰∏™ÂÆû‰æãÈÉΩËøôÊ†∑ÂÅö
window.addEventListener('resize', this.handleResize)
```

**‰ºòÂåñÊñπÊ°àÔºàÂÖ±‰∫´ÁõëÂê¨Âô®Ôºâ:**

```javascript
// ÂÖ®Â±ÄÂè™Êúâ‰∏Ä‰∏™ÁõëÂê¨Âô®
ResizeManager.getInstance().addListener(this.callback)
```

### ÊÄßËÉΩÊèêÂçá

1. **‰∫ã‰ª∂ÁõëÂê¨Âô®Êï∞Èáè**: ‰ªé N ‰∏™ÂáèÂ∞ëÂà∞ 1 ‰∏™
2. **ÂÜÖÂ≠ò‰ΩøÁî®**: ÊòæËëóÂáèÂ∞ëÈáçÂ§çÁöÑ‰∫ã‰ª∂Â§ÑÁêÜÂáΩÊï∞
3. **CPU ‰ΩøÁî®**: ÂáèÂ∞ëÈáçÂ§çÁöÑ‰∫ã‰ª∂Â§ÑÁêÜËÆ°ÁÆó
4. **Ëá™Âä®Ê∏ÖÁêÜ**: ÈÅøÂÖçÂÜÖÂ≠òÊ≥ÑÊºè

## Ë∞ÉËØïÂíåÈ™åËØÅ

### È™åËØÅÂÖ±‰∫´ÁõëÂê¨Âô®

1. ÊâìÂºÄÊµèËßàÂô®ÂºÄÂèëËÄÖÂ∑•ÂÖ∑
2. Âú® Console ‰∏≠ËøêË°åÔºö
   ```javascript
   // Êü•ÁúãÂΩìÂâçÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®Êï∞Èáè
   getEventListeners(window).resize.length
   ```
3. Â∫îËØ•ÁúãÂà∞Âè™Êúâ 1 ‰∏™ resize ÁõëÂê¨Âô®ÔºåÊó†ËÆ∫ÊúâÂ§öÂ∞ë‰∏™ twind-scope ÂÆû‰æã

### ÊÄßËÉΩÁõëÊéß

```javascript
// ÁõëÊéß ResizeManager Áä∂ÊÄÅ
console.log('ÁõëÂê¨Âô®Êï∞Èáè:', ResizeManager.getInstance().listeners.size)
console.log('ÊòØÂê¶Ê≠£Âú®ÁõëÂê¨:', ResizeManager.getInstance().isListening)
```

## ÊúÄ‰Ω≥ÂÆûË∑µ

1. **ÈÅøÂÖçÂú®ÁªÑ‰ª∂ÂÜÖÈÉ®ÂÜçÊ¨°ÁõëÂê¨ resize**: Áõ¥Êé•‰ΩøÁî®Êèê‰æõÁöÑÂìçÂ∫îÂºèÂ±ûÊÄß
2. **‰ΩøÁî®ËÆ°ÁÆóÂ±ûÊÄß**: ÂØπ‰∫éÂ§çÊùÇÁöÑÂìçÂ∫îÂºèÈÄªËæëÔºå‰ΩøÁî® Alpine.js ÁöÑ getter
3. **ÂêàÁêÜ‰ΩøÁî®Êñ≠ÁÇπ**: ‰ºòÂÖà‰ΩøÁî®ÂÜÖÁΩÆÁöÑÊñ≠ÁÇπÂ±ûÊÄßÔºåÂáèÂ∞ëÈáçÂ§çËÆ°ÁÆó
4. **ÊµãËØï‰∏çÂêåÂ±èÂπïÂ∞∫ÂØ∏**: Á°Æ‰øùÂìçÂ∫îÂºèÈÄªËæëÂú®ÂêÑÁßçËÆæÂ§á‰∏äÊ≠£Â∏∏Â∑•‰Ωú

## Á§∫‰æãÊñá‰ª∂

Êü•Áúã `example.html` Êñá‰ª∂Ëé∑ÂèñÂÆåÊï¥ÁöÑ‰ΩøÁî®Á§∫‰æãÔºåÂåÖÊã¨Ôºö

- Âü∫Á°ÄÂ∞∫ÂØ∏ÊòæÁ§∫
- ÂìçÂ∫îÂºèÊñ≠ÁÇπÊ£ÄÊµã
- Ëá™ÂÆö‰πâÂìçÂ∫îÂºèÈÄªËæë
- Â§öÂÆû‰æãÂçèÂêåÂ∑•‰Ωú

## ÂÖºÂÆπÊÄß

- ÊîØÊåÅÊâÄÊúâÁé∞‰ª£ÊµèËßàÂô®
- ÈúÄË¶Å Alpine.js 3.x
- ÈúÄË¶ÅÊîØÊåÅ Shadow DOM ÁöÑÊµèËßàÂô®
- ÈúÄË¶ÅÊîØÊåÅ ES6+ ËØ≠Ê≥ïÁöÑÁéØÂ¢É
